{"version":3,"file":"onlinetextpreview.min.js","sources":["../src/onlinetextpreview.js"],"sourcesContent":["// This file is part of mod_privatestudentfolder for Moodle - http://moodle.org/\n//\n// It is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// It is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JS showing detailed infos about user's approval status for group approvals in a modal window\n *\n * @module        mod_privatestudentfolder/onlinetextpreview\n * @author        University of Geneva, E-Learning Team\n * @author        Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}\n * @copyright     2025 University of Geneva {@link http://www.unige.ch}\n * @license       http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod_privatestudentfolder/onlinetextpreview\n */\ndefine(['jquery', 'core/modal_factory', 'core/str', 'core/ajax', 'core/log', 'core/notification'], function($,\n        ModalFactory, str, ajax, log, notification) {\n\n    /**\n     * @constructor\n     * @alias module:mod_privatestudentfolder/Onlinetextpreview\n     */\n    var Onlinetextpreview = function() {\n        this.cmid = '';\n    };\n\n    var instance = new Onlinetextpreview();\n\n    /**\n     * Initialises the JavaScript for privatestudentfolder's group approval status tooltips\n     *\n     *\n     * @param {Object} config The configuration\n     */\n    instance.initializer = function(config) {\n        instance.cmid = config.cmid;\n\n        log.info('Initialize onlinetextpreview JS!', 'mod_privatestudentfolder');\n\n        // Prepare modal object!\n        if (!instance.modal) {\n            instance.modalpromise = ModalFactory.create({\n                type: ModalFactory.types.DEFAULT,\n                large: true\n            });\n        }\n\n        str.get_strings([\n            {key: 'preview', component: 'core'},\n            {key: 'onlinetextfilename', component: 'assignsubmission_onlinetext'},\n            {key: 'from', component: 'core'}\n        ]).done(function(s) {\n            log.info('Done loading strings...', 'mod_privatestudentfolder');\n            instance.modalpromise.done(function(modal) {\n                log.info('Done preparing modal', 'mod_privatestudentfolder');\n                instance.modal = modal;\n                $('.path-mod-privatestudentfolder table.privatestudentfolders .onlinetextpreview *').click(function(e) {\n                    e.stopPropagation();\n                    e.preventDefault();\n                    var element = $(e.target);\n\n                    var dataelement = element.parent();\n\n                    var itemid;\n                    try {\n                        itemid = dataelement.data('itemid');\n                    } catch (ex) {\n                        notification.exception(ex);\n                    }\n\n                    ajax.call([\n                        {\n                            methodname: 'mod_privatestudentfolder_get_onlinetextpreview',\n                            args: {itemid: itemid, cmid: instance.cmid},\n                            done: function(data) {\n                                var itemname = '';\n                                if (dataelement.data('itemname').length) {\n                                    itemname = ' ' + s[2].toLowerCase() + ' ' + dataelement.data('itemname');\n                                }\n                                instance.modal.setTitle(s[0] + ' ' + s[1] + itemname);\n                                instance.modal.setBody(data);\n                                instance.modal.show();\n                            },\n                            fail: function(ex) {\n                                notification.exception(ex);\n                            }\n                        }\n                    ]);\n                });\n            });\n        }).fail(function(ex) {\n            log.error('Error getting strings: ' + ex, 'mod_privatestudentfolder');\n        });\n    };\n\n    return instance;\n});\n"],"names":["define","$","ModalFactory","str","ajax","log","notification","instance","this","cmid","initializer","config","info","modal","modalpromise","create","type","types","DEFAULT","large","get_strings","key","component","done","s","click","e","stopPropagation","preventDefault","itemid","dataelement","target","parent","data","ex","exception","call","methodname","args","itemname","length","toLowerCase","setTitle","setBody","show","fail","error"],"mappings":";;;;;;;;;AA4BAA,OAAM,6CAAC,CAAC,SAAU,qBAAsB,WAAY,YAAa,WAAY,qBAAsB,SAASC,EACpGC,aAAcC,IAAKC,KAAMC,IAAKC,cAMlC,IAIIC,SAAW,IAJS,WACpBC,KAAKC,KAAO,IAwEhB,OA7DAF,SAASG,YAAc,SAASC,QAC5BJ,SAASE,KAAOE,OAAOF,KAEvBJ,IAAIO,KAAK,mCAAoC,4BAGxCL,SAASM,QACVN,SAASO,aAAeZ,aAAaa,OAAO,CACxCC,KAAMd,aAAae,MAAMC,QACzBC,OAAO,KAIfhB,IAAIiB,YAAY,CACZ,CAACC,IAAK,UAAWC,UAAW,QAC5B,CAACD,IAAK,qBAAsBC,UAAW,+BACvC,CAACD,IAAK,OAAQC,UAAW,UAC1BC,KAAK,SAASC,GACbnB,IAAIO,KAAK,0BAA2B,4BACpCL,SAASO,aAAaS,KAAK,SAASV,OAChCR,IAAIO,KAAK,uBAAwB,4BACjCL,SAASM,MAAQA,MACjBZ,EAAE,mFAAmFwB,MAAM,SAASC,GAChGA,EAAEC,kBACFD,EAAEE,iBACF,IAIIC,OAFAC,YAFU7B,EAAEyB,EAAEK,QAEQC,SAG1B,IACIH,OAASC,YAAYG,KAAK,SAC7B,CAAC,MAAOC,IACL5B,aAAa6B,UAAUD,GAC3B,CAEA9B,KAAKgC,KAAK,CACN,CACIC,WAAY,iDACZC,KAAM,CAACT,OAAQA,OAAQpB,KAAMF,SAASE,MACtCc,KAAM,SAASU,MACX,IAAIM,SAAW,GACXT,YAAYG,KAAK,YAAYO,SAC7BD,SAAW,IAAMf,EAAE,GAAGiB,cAAgB,IAAMX,YAAYG,KAAK,aAEjE1B,SAASM,MAAM6B,SAASlB,EAAE,GAAK,IAAMA,EAAE,GAAKe,UAC5ChC,SAASM,MAAM8B,QAAQV,MACvB1B,SAASM,MAAM+B,MAClB,EACDC,KAAM,SAASX,IACX5B,aAAa6B,UAAUD,GAC3B,IAGZ,EACJ,EACJ,GAAGW,KAAK,SAASX,IACb7B,IAAIyC,MAAM,0BAA4BZ,GAAI,2BAC9C,IAGG3B,QACX"}