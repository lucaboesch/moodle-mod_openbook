{"version":3,"file":"groupapprovalstatus.min.js","sources":["../src/groupapprovalstatus.js"],"sourcesContent":["// This file is part of mod_privatestudentfolder for Moodle - http://moodle.org/\n//\n// It is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// It is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JS showing detailed infos about user's approval status for group approvals in a modal window\n *\n * @module        mod_privatestudentfolder/groupapprovalstatus\n * @author        University of Geneva, E-Learning Team\n * @author        Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}\n * @copyright     2025 University of Geneva {@link http://www.unige.ch}\n * @license       http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module mod_privatestudentfolder/groupapprovalstatus\n */\ndefine(['jquery', 'core/modal_factory', 'core/str', 'core/templates', 'core/log'], function($, ModalFactory, str, templates, log) {\n\n    /**\n     * @constructor\n     * @alias module:mod_privatestudentfolder/groupapprovalstatus\n     */\n    var Groupapprovalstatus = function() {\n        this.id = '';\n    };\n\n    var instance = new Groupapprovalstatus();\n\n    /**\n     * Initialises the JavaScript for privatestudentfolder's group approval status tooltips\n     *\n     *\n     * @param {Object} config The configuration\n     */\n    instance.initializer = function(config) {\n        instance.id = config.id;\n        instance.mode = config.mode;\n\n        log.info('Initialize groupapprovalstatus JS!', 'mod_privatestudentfolder');\n\n        // Prepare modal object!\n        if (!instance.modal) {\n            instance.modalpromise = ModalFactory.create({\n                type: ModalFactory.types.DEFAULT,\n                body: '...'\n            });\n        }\n\n        str.get_string('filedetails', 'mod_privatestudentfolder').done(function(s) {\n            log.info('Done loading strings...', 'mod_privatestudentfolder');\n            instance.modalpromise.done(function(modal) {\n                log.info('Done preparing modal', 'mod_privatestudentfolder');\n                instance.modal = modal;\n                $('.path-mod-privatestudentfolder .statustable .approvaldetails *').click(function(e) {\n                    e.stopPropagation();\n                    var element = $(e.target);\n\n                    var dataelement = element.parent();\n\n                    var approved;\n                    try {\n                        approved = dataelement.data('approved');\n                    } catch (ex) {\n                        approved = [];\n                    }\n\n                    var rejected;\n                    try {\n                        rejected = dataelement.data('rejected');\n                    } catch (ex) {\n                        rejected = [];\n                    }\n\n                    var pending;\n                    try {\n                        pending = dataelement.data('pending');\n                    } catch (ex) {\n                        pending = [];\n                    }\n\n                    var filename;\n                    try {\n                        filename = s + ' ' + dataelement.data('filename');\n                    } catch (ex) {\n                        filename = s;\n                    }\n\n                    var stat;\n                    try {\n                        stat = dataelement.data('status');\n                    } catch (ex) {\n                        stat = {\n                            approved: false,\n                            rejected: false,\n                            pending: false\n                        };\n                    }\n\n                    var context = {\n                        id: instance.id,\n                        mode: instance.mode,\n                        status: stat,\n                        approved: approved,\n                        rejected: rejected,\n                        pending: pending\n                    };\n\n                    // This will call the function to load and render our template.\n                    var promise = templates.render('mod_privatestudentfolder/approvaltooltip', context);\n\n                    // How we deal with promise objects is by adding callbacks.\n                    promise.done(function(source) {\n                        // Here eventually I have my compiled template, and any javascript that it generated.\n                        instance.modal.setTitle(filename);\n                        instance.modal.setBody(source);\n                        instance.modal.show();\n                    }).fail(function(ex) {\n                        // Deal with this exception (I recommend core/notify exception function for this).\n                        instance.modal.setBody(ex.message);\n                        instance.modal.show();\n                    });\n                });\n                // Everything is prepared, fade the symbols in!\n                $('.path-mod-privatestudentfolder .statustable .approvaldetails').fadeIn('slow');\n            });\n        }).fail(function(ex) {\n            log.error('Error getting strings: ' + ex, 'mod_privatestudentfolder');\n        });\n    };\n\n    return instance;\n});\n"],"names":["define","$","ModalFactory","str","templates","log","instance","this","id","initializer","config","mode","info","modal","modalpromise","create","type","types","DEFAULT","body","get_string","done","s","click","e","stopPropagation","approved","rejected","pending","filename","stat","dataelement","target","parent","data","ex","context","status","render","source","setTitle","setBody","show","fail","message","fadeIn","error"],"mappings":";;;;;;;;;AA4BAA,OAAM,+CAAC,CAAC,SAAU,qBAAsB,WAAY,iBAAkB,YAAa,SAASC,EAAGC,aAAcC,IAAKC,UAAWC,KAMzH,IAIIC,SAAW,IAJW,WACtBC,KAAKC,GAAK,IA2Gd,OAhGAF,SAASG,YAAc,SAASC,QAC5BJ,SAASE,GAAKE,OAAOF,GACrBF,SAASK,KAAOD,OAAOC,KAEvBN,IAAIO,KAAK,qCAAsC,4BAG1CN,SAASO,QACVP,SAASQ,aAAeZ,aAAaa,OAAO,CACxCC,KAAMd,aAAae,MAAMC,QACzBC,KAAM,SAIdhB,IAAIiB,WAAW,cAAe,4BAA4BC,KAAK,SAASC,GACpEjB,IAAIO,KAAK,0BAA2B,4BACpCN,SAASQ,aAAaO,KAAK,SAASR,OAChCR,IAAIO,KAAK,uBAAwB,4BACjCN,SAASO,MAAQA,MACjBZ,EAAE,kEAAkEsB,MAAM,SAASC,GAC/EA,EAAEC,kBACF,IAIIC,SAOAC,SAOAC,QAOAC,SAOAC,KA9BAC,YAFU9B,EAAEuB,EAAEQ,QAEQC,SAG1B,IACIP,SAAWK,YAAYG,KAAK,WAC/B,CAAC,MAAOC,IACLT,SAAW,EACf,CAGA,IACIC,SAAWI,YAAYG,KAAK,WAC/B,CAAC,MAAOC,IACLR,SAAW,EACf,CAGA,IACIC,QAAUG,YAAYG,KAAK,UAC9B,CAAC,MAAOC,IACLP,QAAU,EACd,CAGA,IACIC,SAAWP,EAAI,IAAMS,YAAYG,KAAK,WACzC,CAAC,MAAOC,IACLN,SAAWP,CACf,CAGA,IACIQ,KAAOC,YAAYG,KAAK,SAC3B,CAAC,MAAOC,IACLL,KAAO,CACHJ,UAAU,EACVC,UAAU,EACVC,SAAS,EAEjB,CAEA,IAAIQ,QAAU,CACV5B,GAAIF,SAASE,GACbG,KAAML,SAASK,KACf0B,OAAQP,KACRJ,SAAUA,SACVC,SAAUA,SACVC,QAASA,SAICxB,UAAUkC,OAAO,2CAA4CF,SAGnEf,KAAK,SAASkB,QAElBjC,SAASO,MAAM2B,SAASX,UACxBvB,SAASO,MAAM4B,QAAQF,QACvBjC,SAASO,MAAM6B,MACnB,GAAGC,KAAK,SAASR,IAEb7B,SAASO,MAAM4B,QAAQN,GAAGS,SAC1BtC,SAASO,MAAM6B,MACnB,EACJ,GAEAzC,EAAE,gEAAgE4C,OAAO,OAC7E,EACJ,GAAGF,KAAK,SAASR,IACb9B,IAAIyC,MAAM,0BAA4BX,GAAI,2BAC9C,IAGG7B,QACX"}